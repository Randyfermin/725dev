<!DOCTYPE html>

<html lang="es">
    
    <head>

        <meta charset="UTF-8"> 
        <meta name="viewport" content="width=device-width">
        <title>Encriptador Alura</title>
        <link rel="stylesheet" href="css/reset.css">
        <link rel="stylesheet" href="css/encript.css">
        
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300&display=swap" rel="stylesheet">

    </head>

    <body>
        <header> 
            <div class="caja">
                <h1><img src="imagenes/logo.png">Encriptador de Mensajes Alura</h1>
            </div>
        </header>
        <main>
            <div class="first">
                <div class="msj">
                    <label for="mensaje">Mensaje a Encriptar/Desencriptar</label>
                    <input type="text" id="mensaje" required></input>
                </div>
                <div class="btns">
                    <label class="btn_label"><img src="imagenes/bi_exclamation-circle-fill.png">
                        Solo letras minúsculas y sin acentos</label>
                    <input value="Encriptar" type="button" class="btn_encriptar" onclick="encriptar_msj()">
                    <input value="Desencriptar" type="button" class="btn_desencriptar" onclick="desencriptar_msj()">
                </div>
            </div>
            <div id="msj_buscar" class="second">
                <img id="Img01" class="muneco" src="imagenes/Muneco.png" alt="">
                <div id="div_msj" class="div_msj">
                    <p><strong>Ningún mensaje fue encontrado</strong><br>Ingresa el texto que desees encriptar o desencriptar.</p>
                </div>
            </div>
            <div id="div_resultado" class="second" style="display:none;">
                <div id="div_msj_encriptado" class="div_msj_encriptado">
                    <p id="msj_encriptado"></p>
                </div>
                <div class="div_btn_copiar">
                    <input id="btn_copiar" class="btn_copiar" value="Copiar" type="button" onclick="copyText()" >
                </div>
            </div>
        </main>
        <footer>
            <img src="imagenes/logo.png">
            <p class="copyright">&#169 Copyright Randolfo Fermin Powered by &#169Alura 2023</p>
        </footer>
        <script>
            /*  La letra "e" es convertida para "enter"
                La letra "i" es convertida para "imes"
                La letra "a" es convertida para "ai"
                La letra "o" es convertida para "ober"
                La letra "u" es convertida para "ufat"*/
            function isVowel(c) {
                    return ['a', 'e', 'i', 'o', 'u'].indexOf(c.toLowerCase()) !== -1
                }

            function encriptar(vChr){
                switch(vChr) {
                case "e":
                    // code block
                    return "enter";
                    break;
                case "i":
                    // code block
                    return "imes";
                    break;
                case "a":
                    // code block
                    return "ai";
                    break;
                case "o":
                    // code block
                    return "ober";
                    break;
                case "u":
                    // code block
                    return "ufat";
                    break;
                } 
            }

            function encriptar_msj() {
              var str = document.getElementById("mensaje").value;
              var newStr = "";
              if (str.length > 0)
              {
                document.getElementById("msj_buscar").style.display = "none";
                document.getElementById("div_resultado").style.display = "inline-block";

                    for (var i = 0; i < str.length; i++) {
                        
                        if (isVowel(str[i])){  
                            newStr = newStr + (encriptar(str[i])); 
                            
                        }else{
                            newStr = newStr + str[i]; 
                        }  

                    }
                    document.getElementById("msj_encriptado").innerText = newStr;

                }
                else{
                    document.getElementById("msj_buscar").style.display = "inline-block";
                    document.getElementById("div_resultado").style.display = "none";
                }
            }

            function desencriptar_msj(){


                //aqui hay otro cambio
                let text = document.getElementById("msj_encriptado").innerText;
                let myArray = text.split(" ");
                let new_Msj = "";
                let newword = "";
                 
                for (var i = 0; i < myArray.length; i++) {
                    let word = myArray[i];
                    let key_founded = false;
                    
                    if(found_key(word, /ai/g) != null){
                        word = change_word(word, /ai/g, 'a');                        
                    }

                    if(found_key(word, /enter/g) != null){
                        word = change_word(word, /enter/g, 'e');                        
                    }

                    if(found_key(word, /imes/g) != null){
                        word = change_word(word, /imes/g, 'i');                        
                    }

                    if(found_key(word, /ober/g) != null){
                        word = change_word(word, /ober/g, 'o');                        
                    }

                    if(found_key(word, /ufat/g) != null){
                        word = change_word(word, /ufat/g, 'u');                        
                    }

                    new_Msj = new_Msj + word + " ";
                }
                    alert(new_Msj);
                    
            }

            function change_word(word, key, replacer) {
                
                return word.replace(key, `${replacer}`);;
            }

            function found_key(word, key) {
                
                const found = word.match(key);
                return found;
            }
            
            function copyText() {

                /* Select text area by id*/
                var Text = document.getElementById("msj_encriptado").innerText;

                /* Select the text inside text area. */
                Text.select();

                /* Copy selected text into clipboard */
                navigator.clipboard.writeText(Text.value);

                /* Set the copied text as text for
                div with id clipboard 
                document.getElementById("clipboard").innerHTML = Text.value; */
                }
            </script>
    </body>
</html>